include:
  - evic-help-housing-checklist.yml
---
code: |
  client.initializeAttribute('rent', DAObject)
  client.initializeAttribute('owed', DAObject)
  client.initializeAttribute('subsidy', DAObject)

  has_subsidy = False

  if client.housing_type == "public":
    has_subsidy = True
  elif client.housing_type == "unknown":
    if client.subsidy.income_report:
      has_subsidy = True
    else:
      saw_private_housing_notice

  if has_subsidy:
    in_public = client.subsidy.types["voucher"] or client.subsidy.types["authority"] or client.subsidy.types["money"]
    if in_public:
      saw_public_housing_notice
    elif client.subsidy.types["tax_credit"] and not in_public:
      saw_tax_credit_notice
    else:
      uncertain_subsidy
  
  if has_subsidy:
    client.rent.subsidized_cost
       
  bad_conditions_completed
  
  if client.owed.owes_rent is True:
    client.owed.rent
  
  if len(bad_conditions_string) > 0:
    if client.owed.owes_rent == True and client.rent.should_be_reduced == True:
      client.owed.reduction = client.owed.rent - client.owed.reduced_rent

  known_issues = []
  for time in [1, 5, 30]:
    if len(problems_to_fix[time]) > 0:
      known_issues += problems_to_fix[time]
      
  if additional_conditions_present == True:
    known_issues.append(additional_conditions)
      
  if len(bad_conditions_string) > 0:
    repairs 
    total_repairs = "I would like my landlord to address the following issues: \n" + ", ".join(known_issues) + "\n" + repairs
      
  if case.payments_to != "none":
    case.payment_amount
    
  processed_intro = True
---
question: |
  ${question_id("Worksheet:2")}What is your unit's address?
fields:
  - no label: client.address.address
section: Rent
---
need: client.address.address
question: |
  ${question_id("Worksheet:3")}How often do you pay rent?
field: client.rent.frequency
buttons:
  - weekly
  - monthly
---
need: client.rent.frequency
question: |
  ${question_id("Worksheet:4")}How much rent does your landlord charge every ${ client.rent.frequency[:-2] }?
fields:
  - no label: client.rent.value
    datatype: currency
    min: 0
comment: |
  have some help text or a note 
---
need: client.rent.value
question: |
  ${question_id("Worksheet:5")}Housing
subquestion: |
  If you need to move out, your housing choices in the future depend on: 

  * the kind of housing you live in now, and 
  * the terms your landlord agrees to.
  
  If you are not sure of the kind of housing you live in now, we can help you figure it out.

  I live in:
field: client.housing_type
choices:
  - Private housing: private
  - Public or subsidized housing: public
  - I am not sure what kind of housing I have: unknown
---
question: |
  ${question_id("Worksheet:5.1")}Is your rent based partly on your income?
subquestion: |
  Do you have to report your income to your landlord every year?
yesno: client.subsidy.income_report
---
question: |
  ${question_id("Worksheet:6.1")}You probably live in private housing.
subquestion: |
  Neither you nor your landlord get money from the government to help pay your rent. 

  The rules about Emergency Shelter Assistance and government funded housing programs do not apply to you. 
field: saw_private_housing_notice
---
question: |
  ${question_id("Worksheet:6.2")}Types of government funded housing
subquestion: |
  Please check all boxes that are true for you
fields:
  - no label: client.subsidy.types
    datatype: checkboxes
    choices:
      - I get / have a  housing voucher: voucher
      - My landlord is a housing authority: authority
      - My landlord gets money from the government to provide affordable housing: money
      - My landlord gets a tax credit from the government to provide affordable housing: tax_credit 
---
question: |
  ${question_id("Worksheet:7.1")}It seems that you live in public or subsidized housing
subquestion: |
  If you are evicted from one these housing programs for non-payment of rent, you cannot get Emergency Assistance Shelter after you move out.  
  
  If your landlord evicts you because you violated the lease or you did not pay rent, you cannot get into another subsidized housing program for at least 2 years. And you must pay  back all the rent you owe, before you can get into another subsidized or public housing program
  
  But you can ask the landlord to help you keep your housing choices open when you negotiate your agreement.
  
  In the worksheet and agreement you get at the end of this interview, you will find find words and terms to ask for, so you can you keep your options open.
field: saw_public_housing_notice
---
question: |
  ${question_id("Worksheet:7.2")}It looks like you live in a tax-credit unit.
subquestion: |
  The only government funding that goes toward your housing is that the government gives your landlord a tax credit for keeping your rent affordable. 
  
  The rules that would keep you out of Emergency Assistance Shelter and public and subsidized housing after getting evicted probably do not apply to you. 
  
  To be absolutely sure, you may want to check with your landlord about the kind of housing you have. 
field: saw_tax_credit_notice
---
event: uncertain_subsidy
question: |
  ${question_id("Worksheet:7.3")}Still uncertain?
subquestion: |
  What you can do next depends on knowing the kind of housing you live in. 
  It is probably best to stop the interview now and find out. 
  Ask your landlord about the kind of housing you live in. 
  If you have a written lease it should be in there. 
  If your lease is not written you may live in private housing. 
buttons:
  - I want to keep going: continue
  - I want to stop now and find out about the kind of housing I live in: exit
---
question: |
  ${question_id("Worksheet:8")}What portion of the rent do you pay?
subquestion: |
  This should be less than the current rent of $${ client.rent.value }
fields: 
  - no label: client.rent.subsidized_cost
    datatype: currency
    min: 0
    max: ${ client.rent.value }
---
need: client.subsidy.types
question: |
  ${question_id("Worksheet:9")}Do you owe rent?
yesnomaybe: client.owed.owes_rent
---
question: |
  ${question_id("Worksheet:10")}How much rent do you owe?
fields:
  - no label: client.owed.rent
    datatype: currency
    min: 0
---
question: |
  ${question_id("Worksheet:11")}Should your landlord lower your rent?
subquestion: |
  One reason your landlord should lower your rent is because of the bad conditions in your apartment.
yesno: client.rent.should_be_reduced
---
question: |
  ${question_id("Worksheet:12")}What should the lower rent be?
subquestion: |
  For reference, you said you owe $${ client.owed.rent }
fields:
  - no label: client.owed.reduced_rent
    datatype: currency
    min: 0
    max: ${ client.owed.rent }
  - I don't know: client.owed.unknown_reduction
    datatype: yesnowide
---
question: |
  ${question_id("Worksheet:13")}Does the apartment need repairs?
subquestion: |
  % if len(known_issues) > 0:
  If there are any additional repairs or conditions you yould like mentioned, please add them here.
  CR edit: Describe or list any more repairs or bad conditions your apartment needs fixing.
  
  The problems you already told me about are:
    <ul>
    % for issue in known_issues:
      <li>${ issue }</li>
    % endfor
    </ul>
  % else:
    You did not mention any issues
  % endif
fields:
  - no label: repairs
    datatype: area
    required: false
---
section: Payments
question: |
  ${question_id("Worksheet:14")}Does your landlord owe you money?
fields:
  - note: Reasons your landlord may owe your money
  - no label: landlord.reasons_to_owe
    datatype: checkboxes
    choices:
      - Utilities: utilities
      - Security Deposit: deposit
      - Entering your apartment without permission: entering
      - I paid for repairs: repairs
      - other: other
  - Other issues: landlord.other_reasons_to_owe
    datatype: area
    show if: landlord.reasons_to_owe['other']
---
question: |
  ${question_id("Worksheet:15")}Should your landlord lower the rent you owe?
fields:
  - no label: landlord.should_reduce_rent  
    datatype: yesnoradio
  - "What should the reduced amount be?": client.rent.reduced_value
    datatype: currency
    min: 0
    max: client.owed.rent
    js show if: |
      val("landlord.should_reduce_rent") === true
---
question: |
  ${question_id("Worksheet:16")}Do you need a payment plan to help you pay back rent you owe?
yesno: client.owed.payment_plan
---
question: |
  Describe how you would like to pay your landlord
---
section: Payments
question: |
  ${question_id("Worksheet:17")}Who should pay whom?
subquestion: |
  You may want to pay your landlord back rent, while you are waiting for a court decision (?), or to resolve their claims (need better Plain Language here).
  You might want your landlord to pay you for repairs living with bad conditions...(to resolve your claims).
fields: 
  - no label: case.payments_to
    datatype: radio
    choices: 
      - I would like to make payments to my landlord: landlord
      - My landlord should pay me: tenant
      - No: none
---
question: | 
  ${question_id("Worksheet:18")}Tell me about the payments ${ "you" if case.payments_to == "tenant" else "your landlord" } should make.
fields: 
  - note: How much should they/you (variable to be defined) pay?
  - no label: case.payment_amount
    datatype: currency
  - note: | 
      How should ${ "you" if case.payments_to == "tenant" else "your landlord" } pay.
      This could be payments on a certain date, a rent credit, or some other way
    datatype: area
---